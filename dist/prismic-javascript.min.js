!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("fetch-everywhere")):"function"==typeof define&&define.amd?define("PrismicJS",["fetch-everywhere"],e):"object"==typeof exports?exports.PrismicJS=e(require("fetch-everywhere")):t.PrismicJS=e(t["fetch-everywhere"])}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=2)}([function(t,e,n){"use strict";function r(t){return"string"==typeof t?'"'+t+'"':t instanceof Array?"["+t.map(function(t){return r(t)}).join(",")+"]":"number"==typeof t?t:null}e.__esModule=!0;var o={at:"at",not:"not",missing:"missing",has:"has",any:"any",in:"in",fulltext:"fulltext",similar:"similar","number.gt":"number.gt","number.lt":"number.lt","number.inRange":"number.inRange","date.before":"date.before","date.after":"date.after","date.between":"date.between","date.day-of-month":"date.day-of-month","date.day-of-month-after":"date.day-of-month-after","date.day-of-month-before":"date.day-of-month-before","date.day-of-week":"date.day-of-week","date.day-of-week-after":"date.day-of-week-after","date.day-of-week-before":"date.day-of-week-before","date.month":"date.month","date.month-before":"date.month-before","date.month-after":"date.month-after","date.year":"date.year","date.hour":"date.hour","date.hour-before":"date.hour-before","date.hour-after":"date.hour-after","geopoint.near":"geopoint.near"},i={near:function(t,e,n,r){return"["+o["geopoint.near"]+"("+t+", "+e+", "+n+", "+r+")]"}},a={before:function(t,e){return"["+o["date.before"]+"("+t+", "+e.getTime()+")]"},after:function(t,e){return"["+o["date.after"]+"("+t+", "+e.getTime()+")]"},between:function(t,e,n){return"["+o["date.between"]+"("+t+", "+e.getTime()+", "+n.getTime()+")]"},dayOfMonth:function(t,e){return"["+o["date.day-of-month"]+"("+t+", "+e+")]"},dayOfMonthAfter:function(t,e){return"["+o["date.day-of-month-after"]+"("+t+", "+e+")]"},dayOfMonthBefore:function(t,e){return"["+o["date.day-of-month-before"]+"("+t+", "+e+")]"},dayOfWeek:function(t,e){return"["+o["date.day-of-week"]+"("+t+", "+e+")]"},dayOfWeekAfter:function(t,e){return"["+o["date.day-of-week-after"]+"("+t+", "+e+")]"},dayOfWeekBefore:function(t,e){return"["+o["date.day-of-week-before"]+"("+t+", "+e+")]"},month:function(t,e){return"number"==typeof e?"["+o["date.month"]+"("+t+", "+e+")]":"["+o["date.month"]+"("+t+', "'+e+'")]'},monthBefore:function(t,e){return"number"==typeof e?"["+o["date.month-before"]+"("+t+", "+e+")]":"["+o["date.month-before"]+"("+t+', "'+e+'")]'},monthAfter:function(t,e){return"number"==typeof e?"["+o["date.month-after"]+"("+t+", "+e+")]":"["+o["date.month-after"]+"("+t+', "'+e+'")]'},year:function(t,e){return"["+o["date.year"]+"("+t+", "+e+")]"},hour:function(t,e){return"["+o["date.hour"]+"("+t+", "+e+")]"},hourBefore:function(t,e){return"["+o["date.hour-before"]+"("+t+", "+e+")]"},hourAfter:function(t,e){return"["+o["date.hour-after"]+"("+t+", "+e+")]"}},u={gt:function(t,e){return"["+o["number.gt"]+"("+t+", "+e+")]"},lt:function(t,e){return"["+o["number.lt"]+"("+t+", "+e+")]"},inRange:function(t,e,n){return"["+o["number.inRange"]+"("+t+", "+e+", "+n+")]"}};e.default={at:function(t,e){return"["+o.at+"("+t+", "+r(e)+")]"},not:function(t,e){return"["+o.not+"("+t+", "+r(e)+")]"},missing:function(t){return"["+o.missing+"("+t+")]"},has:function(t){return"["+o.has+"("+t+")]"},any:function(t,e){return"["+o.any+"("+t+", "+r(e)+")]"},in:function(t,e){return"["+o.in+"("+t+", "+r(e)+")]"},fulltext:function(t,e){return"["+o.fulltext+"("+t+", "+r(e)+")]"},similar:function(t,e){return"["+o.similar+'("'+t+'", '+e+")]"},date:a,dateBefore:a.before,dateAfter:a.after,dateBetween:a.between,dayOfMonth:a.dayOfMonth,dayOfMonthAfter:a.dayOfMonthAfter,dayOfMonthBefore:a.dayOfMonthBefore,dayOfWeek:a.dayOfWeek,dayOfWeekAfter:a.dayOfWeekAfter,dayOfWeekBefore:a.dayOfWeekBefore,month:a.month,monthBefore:a.monthBefore,monthAfter:a.monthAfter,year:a.year,hour:a.hour,hourBefore:a.hourBefore,hourAfter:a.hourAfter,number:u,gt:u.gt,lt:u.lt,inRange:u.inRange,near:i.near,geopoint:i}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(6),o=n(7),i=n(0),a=n(8);e.PREVIEW_COOKIE="io.prismic.preview",e.EXPERIMENT_COOKIE="io.prismic.experiment";var u=function(){function t(t,e,n){this.data=t,this.masterRef=t.refs.filter(function(t){return t.isMasterRef})[0],this.experiments=new r.Experiments(t.experiments),this.bookmarks=t.bookmarks,this.httpClient=e,this.options=n,this.refs=t.refs,this.tags=t.tags,this.types=t.types}return t.prototype.form=function(t){var e=this.data.forms[t];return e?new o.SearchForm(e,this.httpClient):null},t.prototype.everything=function(){var t=this.form("everything");if(!t)throw new Error("Missing everything form");return t},t.prototype.master=function(){return this.masterRef.ref},t.prototype.ref=function(t){var e=this.data.refs.filter(function(e){return e.label===t})[0];return e?e.ref:null},t.prototype.currentExperiment=function(){return this.experiments.current()},t.prototype.query=function(t,n,r){void 0===r&&(r=function(){});var o="function"==typeof n?{options:{},callback:n}:{options:n||{},callback:r},i=o.options,u=o.callback,f=this.everything();for(var s in i)f=f.set(s,i[s]);if(!i.ref){var c="";this.options.req?c=this.options.req.headers.cookie||"":"undefined"!=typeof window&&window.document&&(c=window.document.cookie||"");var h=a.default.parse(c),d=h[e.PREVIEW_COOKIE],l=this.experiments.refFromCookie(h[e.EXPERIMENT_COOKIE]);f=f.ref(d||l||this.masterRef.ref)}return t&&f.query(t),f.submit(u)},t.prototype.queryFirst=function(t,e,n){void 0===n&&(n=function(){});var r="function"==typeof e?{options:{},callback:e}:{options:e||{},callback:n},o=r.options,i=r.callback;return o.page=1,o.pageSize=1,this.query(t,o,function(t,e){if(i){var n=e&&e.results&&e.results[0];i(t,n)}}).then(function(t){return t&&t.results&&t.results[0]}).catch(function(t){console.log(t)})},t.prototype.getByID=function(t,e,n){var r=e||{};return r.lang||(r.lang="*"),this.queryFirst(i.default.at("document.id",t),r,n)},t.prototype.getByIDs=function(t,e,n){var r=e||{};return r.lang||(r.lang="*"),this.query(i.default.in("document.id",t),r,n)},t.prototype.getByUID=function(t,e,n,r){var o=n||{};return o.lang||(o.lang="*"),this.queryFirst(i.default.at("my."+t+".uid",e),o,r)},t.prototype.getSingle=function(t,e,n){return this.queryFirst(i.default.at("document.type",t),e,n)},t.prototype.getBookmark=function(t,e,n){var r=this;return new Promise(function(e,o){var i=r.data.bookmarks[t];if(i)e(i);else{var a=new Error("Error retrieving bookmarked id");n&&n(a,null),o(a)}}).then(function(t){return r.getByID(t,e,n)})},t.prototype.previewSession=function(t,e,n,r){var o=this;return new Promise(function(r,i){var a=function(t,e,n){a&&a(t,e,n),t?i(t):r(e)};o.httpClient.request(t,function(t,r,i){if(t)return void a(t,n,i);try{var u=r.mainDocument;u?o.getByID(u,{},function(t,r){t&&a(t);try{r?a(null,e(r),i):a(null,n,i)}catch(t){a(t)}}):a(null,n,i)}catch(t){a(t,n,i)}})})},t}();e.default=u},function(t,e,n){n(3),t.exports=n(4)},function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t,e){return new i.Api(t,e).get()}e.__esModule=!0;var o=n(0),i=n(5),a=n(1);t.exports={Predicates:o.default,Api:i.Api,getApi:r,api:r,experimentCookie:a.EXPERIMENT_COOKIE,previewCookie:a.PREVIEW_COOKIE}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(1),o=n(9),i=function(){function t(t,e){this.options=e||{},this.url=t+(this.options.accessToken?(t.indexOf("?")>-1?"&":"?")+"access_token="+this.options.accessToken:""),this.apiDataTTL=this.options.apiDataTTL||5,this.httpClient=new o.default(this.options.requestHandler,this.options.apiCache,this.options.proxyAgent)}return t.prototype.get=function(t){var e=this;return this.httpClient.cachedRequest(this.url,{ttl:this.apiDataTTL}).then(function(n){var o=new r.default(n,e.httpClient,e.options);return t&&t(null,o),o}).catch(function(e){throw t&&t(e,null),e})},t}();e.Api=i},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){function t(t){this.data={},this.data=t}return t.prototype.id=function(){return this.data.id},t.prototype.ref=function(){return this.data.ref},t.prototype.label=function(){return this.data.label},t}();e.Variation=r;var o=function(){function t(t){this.data={},this.data=t,this.variations=(t.variations||[]).map(function(t){return new r(t)})}return t.prototype.id=function(){return this.data.id},t.prototype.googleId=function(){return this.data.googleId},t.prototype.name=function(){return this.data.name},t}();e.Experiment=o;var i=function(){function t(t){t&&(this.drafts=(t.drafts||[]).map(function(t){return new o(t)}),this.running=(t.running||[]).map(function(t){return new o(t)}))}return t.prototype.current=function(){if(this.running.length>0)return this.running[0]},t.prototype.refFromCookie=function(t){if(!t||""===t.trim())return null;var e=t.trim().split(" ");if(e.length<2)return null;var n=e[0],r=parseInt(e[1],10),o=this.running.filter(function(t){return t.googleId()==n&&t.variations.length>r})[0];return o?o.variations[r].ref():null},t}();e.Experiments=i},function(t,e,n){"use strict";e.__esModule=!0;var r=function(){function t(t,e){this.httpClient=e,this.form=t,this.data={};for(var n in t.fields)t.fields[n].default&&(this.data[n]=[t.fields[n].default])}return t.prototype.set=function(t,e){var n=this.form.fields[t];if(!n)throw new Error("Unknown field "+t);var r=""===e||void 0===e?null:e,o=this.data[t]||[];return o=n.multiple?r?o.concat([r]):o:r?[r]:o,this.data[t]=o,this},t.prototype.ref=function(t){return this.set("ref",t)},t.prototype.query=function(t){if("string"==typeof t)return this.query([t]);if(t instanceof Array)return this.set("q","["+t.join("")+"]");throw new Error("Invalid query : "+t)},t.prototype.pageSize=function(t){return this.set("pageSize",t)},t.prototype.fetch=function(t){var e=t instanceof Array?t.join(","):t;return this.set("fetch",e)},t.prototype.fetchLinks=function(t){var e=t instanceof Array?t.join(","):t;return this.set("fetchLinks",e)},t.prototype.lang=function(t){return this.set("lang",t)},t.prototype.page=function(t){return this.set("page",t)},t.prototype.after=function(t){return this.set("after",t)},t.prototype.orderings=function(t){return t?this.set("orderings","["+t.join(",")+"]"):this},t.prototype.url=function(){var t=this.form.action;if(this.data){var e=t.indexOf("?")>-1?"&":"?";for(var n in this.data)if(this.data.hasOwnProperty(n)){var r=this.data[n];if(r)for(var o=0;o<r.length;o++)t+=e+n+"="+encodeURIComponent(r[o]),e="&"}}return t},t.prototype.submit=function(t){return this.httpClient.cachedRequest(this.url(),t)},t}();e.SearchForm=r},function(t,e,n){"use strict";function r(t,e){try{return e(t)}catch(e){return t}}function o(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");var n={},o=e||{},a=o.decode||i;return t.split(/; */).forEach(function(t){var e=t.indexOf("=");if(!(e<0)){var o=t.substr(0,e).trim(),i=t.substr(++e,t.length).trim();'"'==i[0]&&(i=i.slice(1,-1)),void 0==n[o]&&(n[o]=r(i,a))}}),n}e.__esModule=!0;var i=decodeURIComponent;e.default={parse:o}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(10),o=n(12),i=function(){function t(t,e,n){this.requestHandler=t||new o.DefaultRequestHandler({proxyAgent:n}),this.cache=e||new r.DefaultApiCache}return t.prototype.request=function(t,e){var n=this;return new Promise(function(r,o){n.requestHandler.request(t,function(t,n,i){t?(o(t),e(t,null,i)):(r(n),e(null,n,i))})})},t.prototype.cachedRequest=function(t,e){var n=this,r=function(r){var o=e&&e.cacheKey||t;n.cache.get(o,function(e,i){if(e||i)return void r(e,i);n.requestHandler.request(t,function(t,e,i,a){if(t)return void r(t,null,i);a?n.cache.set(o,e,a,function(t){r(t,e)}):r(null,e)})})};return new Promise(function(t,e){r(function(n,r,o){n&&e(n),r&&t(r)})})},t}();e.default=i},function(t,e,n){"use strict";e.__esModule=!0;var r=n(11),o=function(){function t(t){this.lru=r.MakeLRUCache(t)}return t.prototype.isExpired=function(t){var e=this.lru.get(t,!1);return!!e&&0!==e.expiredIn&&e.expiredIn<Date.now()},t.prototype.get=function(t,e){var n=this.lru.get(t,!1);n&&!this.isExpired(t)?e(null,n.data):e()},t.prototype.set=function(t,e,n,r){this.lru.remove(t),this.lru.put(t,{data:e,expiredIn:n?Date.now()+1e3*n:0}),r()},t.prototype.remove=function(t,e){this.lru.remove(t),e()},t.prototype.clear=function(t){this.lru.removeAll(),t()},t}();e.DefaultApiCache=o},function(t,e,n){"use strict";function r(t){return new o(t)}function o(t){this.size=0,this.limit=t,this._keymap={}}e.__esModule=!0,e.MakeLRUCache=r,o.prototype.put=function(t,e){var n={key:t,value:e};if(this._keymap[t]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit)return this.shift();this.size++},o.prototype.shift=function(){var t=this.head;return t&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,t.newer=t.older=void 0,delete this._keymap[t.key]),console.log("purging ",t.key),t},o.prototype.get=function(t,e){var n=this._keymap[t];if(void 0!==n)return n===this.tail?e?n:n.value:(n.newer&&(n===this.head&&(this.head=n.newer),n.newer.older=n.older),n.older&&(n.older.newer=n.newer),n.newer=void 0,n.older=this.tail,this.tail&&(this.tail.newer=n),this.tail=n,e?n:n.value)},o.prototype.find=function(t){return this._keymap[t]},o.prototype.set=function(t,e){var n,r=this.get(t,!0);return r?(n=r.value,r.value=e):(n=this.put(t,e))&&(n=n.value),n},o.prototype.remove=function(t){var e=this._keymap[t];if(e)return delete this._keymap[e.key],e.newer&&e.older?(e.older.newer=e.newer,e.newer.older=e.older):e.newer?(e.newer.older=void 0,this.head=e.newer):e.older?(e.older.newer=void 0,this.tail=e.older):this.head=this.tail=void 0,this.size--,e.value},o.prototype.removeAll=function(){this.head=this.tail=void 0,this.size=0,this._keymap={}},"function"==typeof Object.keys?o.prototype.keys=function(){return Object.keys(this._keymap)}:o.prototype.keys=function(){var t=[];for(var e in this._keymap)t.push(e);return t},o.prototype.forEach=function(t,e,n){var r;if(!0===e?(n=!0,e=void 0):"object"!=typeof e&&(e=this),n)for(r=this.tail;r;)t.call(e,r.key,r.value,this),r=r.older;else for(r=this.head;r;)t.call(e,r.key,r.value,this),r=r.newer},o.prototype.toString=function(){for(var t="",e=this.head;e;)t+=String(e.key)+":"+e.value,(e=e.newer)&&(t+=" < ");return t}},function(t,e,n){"use strict";function r(t,e,n,r){var o={headers:{Accept:"application/json"}};return r&&r.proxyAgent&&(o.agent=r.proxyAgent),fetch(t,o).then(function(e){if(~~(e.status/100!=2)){var n=new Error("Unexpected status code ["+e.status+"] on URL "+t);throw n.status=e.status,n}return e.json().then(function(t){return{response:e,json:t}})}).then(function(t){var n=t.response,r=t.json,o=n.headers.get("cache-control"),i=o?/max-age=(\d+)/.exec(o):null,a=i?parseInt(i[1],10):void 0;e({ttl:a,result:r,xhr:n})}).catch(function(t){n({error:t})})}function o(t){if(!(0===u.length||a>=i)){a++;var e=u.shift(),n=function(n){var r=n.result,i=n.xhr,u=n.ttl;a--,e.callback(null,r,i,u),o(t)},f=function(n){var r=n.error;e.callback(r),o(t)};r(e.url,n,f)}}e.__esModule=!0;var i=20,a=0,u=[],f=function(){function t(t){this.options=t}return t.prototype.request=function(t,e){u.push({url:t,callback:e}),o(this.options)},t}();e.DefaultRequestHandler=f}])});